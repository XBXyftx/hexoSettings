---
title: 开心一笑项目笔记
date: 2025-01-30 23:32:04
tags:
  - 鸿蒙
  - 技术向
cover: https://raw.githubusercontent.com/XBXyftx/hexoImgs3/main/01d66fb92d12560cab59744fa04090f.png
post_copyright:
copyright_author: XBXyftx
copyright_author_href: https://github.com/XBXyftx
copyright_url: https://XBXyftx.github.io
copyright_info: 此文章版权归XBXyftx所有，如有转载，请註明来自原作者
---

## 项目概述

### UI骨架

```ArkTS
/**
 * 1. 默认加载
 * 2. 下拉刷新
 * 3. 触底加载更多
 * 4. 点击返回顶部
 * */
@Entry
@Component
struct Day01_07_Jokes {
  @State jokes: string [] = ['笑话 1']
  jokeNum: number = 5
  @State refreshing: boolean = false
  listScroller: Scroller = new Scroller()

  build() {
    Refresh({ refreshing: $$this.refreshing }) {
      Column() {
        // 顶部
        this.HeaderBuilder()
        // 笑话列表
        List({ space: 10, scroller: this.listScroller }) {
          ForEach(this.jokes, (joke: string) => {
            ListItem() {
              Column({ space: 10 }) {
                Text('笑话标题')
                  .fontSize(20)
                  .fontWeight(600)
                Row({ space: 15 }) {
                  titleIcon({ icon: $r('app.media.ic_public_time'), info: '2024-1-1' })
                  titleIcon({ icon: $r('app.media.ic_public_read'), info: '阅读(6666)' })
                  titleIcon({ icon: $r('app.media.ic_public_comments'), info: '评论(123)' })
                }

                Text(joke)
                  .fontSize(15)
                  .fontColor(Color.Gray)
              }
              .width('100%')
              .alignItems(HorizontalAlign.Start)
              .padding(20)

            }
            .borderRadius(10)
            .backgroundColor(Color.White)
            .shadow({ radius: 2, color: Color.Gray })
          })

        }
        .padding(10)
        .layoutWeight(1)

      }
      .width('100%')
      .height('100%')
      .backgroundColor('#f6f6f6')
    }
  }

  @Builder
  HeaderBuilder() {
    Row() {
      Image($r('app.media.ic_public_drawer_filled'))
        .width(25);

      Image($r('app.media.ic_public_joke_logo'))
        .width(30)

      Image($r('app.media.ic_public_search'))
        .width(30);
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceBetween)
    .height(60)
    .padding(10)
    .border({ width: { bottom: 2 }, color: '#f0f0f0' })
    .backgroundColor(Color.White)
  }
}

@Component
struct titleIcon {
  icon: ResourceStr = ''
  info: string = ''

  build() {
    Row() {
      Image(this.icon)
        .width(15)
        .fillColor(Color.Gray)
      Text(this.info)
        .fontSize(14)
        .fontColor(Color.Gray)
    }
  }
}
```

该UI框架的预览图如下：
![骨架预览](https://raw.githubusercontent.com/XBXyftx/hexoImgs3/main/20250130233642.png)

### 预期目标

1. 默认获取若干条笑话，并渲染到页面上
2. 下拉刷新
3. 触底加载更多
4. 点击返回顶部

## 实现过程

### 默认获取若干条笑话

#### 确认数据格式定义接口

我们可以通过接口文档来确认数据格式定义接口，或是通过获取的数据来自行确认数据格式定义接口。两种方式都可以。

#### 通过接口文档确认数据格式定义接口

接口文档：[开心一笑接口文档](https://apifox.com/apidoc/shared-e3812a75-2d81-4388-abf4-af83a2758a9a/api-153085966)

利用Apifox提供的接口文档，我们可以确认数据格式如下：

![2](开心一笑项目笔记/2.png)

由此定义接口

```ArkTS
interface JokeResponse {
  msg: string
  code: number
  data: string[]
}
```

#### 通过获取的数据确认数据格式定义接口

我们可以通过获取的数据来确认数据格式定义接口。
首先获取数据：

```ArkTS
  aboutToAppear(): void {
    this.req.request(`https://api-vue-base.itheima.net/api/joke/list?num=${this.jokeNum}`)
      .then((res)=>{
        AlertDialog.show({
          message: res.result.toString()
        })
      })
  }
```

![1](开心一笑项目笔记/1.png)

由此定义接口

```ArkTS
interface JokeResponse {
  msg: string
  code: number
  data: string[]
}
```
